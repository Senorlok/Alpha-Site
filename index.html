<!-- THIS IS A COMMENT NOTING THAT THIS IS A STANDARD HTML PAGE WITH STANDARD HTML FORMAT. -->


<h1 style="text-align: center;">Arduino&nbsp;ESP WIFI Switch</h1>
<p>&nbsp;</p>
<p>The following is the code used for the&nbsp;ESP WIFI Switch project:</p>
<p><span style="background-color: #ffffff;"><em>=======================================</em></span></p>
<p><span style="background-color: #ffffff;"><em>#include &lt;ESP8266WiFi.h&gt;</em></span><br /> <br /><span style="background-color: #ffffff;"><em>const char* ssid = "SSID";</em></span><br /><span style="background-color: #ffffff;"><em>const char* password = "SSID_PW";</em></span><br /> <br /><span style="background-color: #ffffff;"><em>int relayPin = D5;</em></span><br /><span style="background-color: #ffffff;"><em>WiFiServer server(80);</em></span></p>
<p><span style="background-color: #ffffff;"><em>int state = LOW; //USER</em></span></p>
<p><span style="background-color: #ffffff;"><em>void setup() {</em></span><br /><span style="background-color: #ffffff;"><em> Serial.begin(9600);</em></span><br /><span style="background-color: #ffffff;"><em> delay(10);</em></span><br /> <br /> <br /><span style="background-color: #ffffff;"><em> pinMode(relayPin, OUTPUT);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Connect to WiFi network</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println();</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println();</em></span><br /><span style="background-color: #ffffff;"><em> Serial.print("Connecting to ");</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println(ssid);</em></span><br /> <br /><span style="background-color: #ffffff;"><em> WiFi.begin(ssid, password);</em></span><br /> <br /><span style="background-color: #ffffff;"><em> while (WiFi.status() != WL_CONNECTED) {</em></span><br /><span style="background-color: #ffffff;"><em> delay(500);</em></span><br /><span style="background-color: #ffffff;"><em> Serial.print(".");</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("");</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("WiFi connected");</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Start the server</em></span><br /><span style="background-color: #ffffff;"><em> server.begin();</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("Server started");</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Print the IP address</em></span><br /><span style="background-color: #ffffff;"><em> Serial.print("Use this URL : ");</em></span><br /><span style="background-color: #ffffff;"><em> Serial.print("http://");</em></span><br /><span style="background-color: #ffffff;"><em> Serial.print(WiFi.localIP());</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("/");</em></span><br /> <br /><span style="background-color: #ffffff;"><em>}</em></span><br /> <br /><span style="background-color: #ffffff;"><em>void loop() {</em></span><br /><span style="background-color: #ffffff;"><em> // Check if a client has connected</em></span><br /><span style="background-color: #ffffff;"><em> WiFiClient client = server.available();</em></span><br /><span style="background-color: #ffffff;"><em> if (!client) {</em></span><br /><span style="background-color: #ffffff;"><em> return;</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Wait until the client sends some data</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("new client");</em></span><br /><span style="background-color: #ffffff;"><em> while(!client.available()){</em></span><br /><span style="background-color: #ffffff;"><em> delay(1);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Read the first line of the request</em></span><br /><span style="background-color: #ffffff;"><em> String request = client.readStringUntil('\r');</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println(request);</em></span><br /><span style="background-color: #ffffff;"><em> client.flush();</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Match the request</em></span><br /> <br /><span style="background-color: #ffffff;"><em> int value = LOW;</em></span><br /><span style="background-color: #ffffff;"><em> state = digitalRead(relayPin); //USER</em></span><br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/LED=ON") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> value = HIGH;</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/LED=OFF") != -1)</em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> value = LOW;</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span></p>
<p><span style="background-color: #ffffff;"><em>//USER</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/LED=SWITCH") != -1 &amp;&amp; state == LOW)</em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> value = HIGH;</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/LED=SWITCH") != -1 &amp;&amp; state == HIGH)</em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> value = LOW;</em></span><br /><span style="background-color: #ffffff;"><em> } </em></span><br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/START") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(100);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> } </em></span><br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/ONE") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(1000);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/TWO") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(2000);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/THREE") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(3000);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/FIVE") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(5000);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if (request.indexOf("/TEN") != -1) </em></span><br /><span style="background-color: #ffffff;"><em> {</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, HIGH);</em></span><br /><span style="background-color: #ffffff;"><em> delay(10000);</em></span><br /><span style="background-color: #ffffff;"><em> digitalWrite(relayPin, LOW);</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /> <br /><span style="background-color: #ffffff;"><em> // Return the response</em></span><br /><span style="background-color: #ffffff;"><em> client.println("HTTP/1.1 200 OK");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Content-Type: text/html");</em></span><br /><span style="background-color: #ffffff;"><em> client.println(""); // do not forget this one</em></span><br /><span style="background-color: #ffffff;"><em> client.println("&lt;!DOCTYPE HTML&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("&lt;html&gt;");</em></span><br /> <br /><span style="background-color: #ffffff;"><em> client.print("Relay is now: ");</em></span><br /> <br /><span style="background-color: #ffffff;"><em> if(value == HIGH) {</em></span><br /><span style="background-color: #ffffff;"><em> client.print("On"); </em></span><br /><span style="background-color: #ffffff;"><em> } else {</em></span><br /><span style="background-color: #ffffff;"><em> client.print("Off or temporarily ON");</em></span><br /><span style="background-color: #ffffff;"><em> }</em></span><br /><span style="background-color: #ffffff;"><em> client.println("&lt;br&gt;&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/LED=ON\"&gt;here&lt;/a&gt; to turn relay ON&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/LED=OFF\"&gt;here&lt;/a&gt; to turn relay OFF&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> //USER</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/LED=SWITCH\"&gt;here&lt;/a&gt; to switch relay&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/START\"&gt;here&lt;/a&gt; to send a START signal&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/ONE\"&gt;here&lt;/a&gt; to turn relay ON for 1 second&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/TWO\"&gt;here&lt;/a&gt; to turn relay ON for 2 seconds&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/THREE\"&gt;here&lt;/a&gt; to turn relay ON for 3 seconds&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/FIVE\"&gt;here&lt;/a&gt; to turn relay ON for 5 seconds&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("Click &lt;a href=\"/TEN\"&gt;here&lt;/a&gt; to turn relay ON for 10 seconds&lt;br&gt;");</em></span><br /><span style="background-color: #ffffff;"><em> client.println("&lt;/html&gt;");</em></span><br /> <br /><span style="background-color: #ffffff;"><em> delay(1);</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("Client disconnected");</em></span><br /><span style="background-color: #ffffff;"><em> Serial.println("");</em></span><br /> <br /><span style="background-color: #ffffff;"><em>}</em></span></p>
<p><span style="background-color: #ffffff;"><em>=======================================</em></span></p>