<!-- THIS IS A COMMENT NOTING THAT THIS IS A STANDARD HTML PAGE WITH STANDARD HTML FORMAT. -->
<h1 style="text-align: center;">Arduino <em>ESP8266&nbsp;</em>WIFI Switch</h1>
<p>&nbsp;</p>
<p>The following is the code used for the&nbsp;NERF PROMETHEUS remote switch project:</p>
<p><span style="background-color: #ffffff;"><em>===================================================</em></span></p>
<p><em><span style="background-color: #ffffff;">#include &lt;ESP8266WiFi.h&gt;</span></em><br /> <br /><em><span style="background-color: #ffffff;">const char* ssid = "SSID";</span></em><br /><em><span style="background-color: #ffffff;">const char* password = "SSID_PW";</span></em></p>
<p><em>int relayPin1 = D1;</em><br /><em>int relayPin2 = D2;</em></p>
<p><em>WiFiServer server(80);</em></p>
<p><em>int state = LOW; //USER</em></p>
<p><em>void setup() {</em><br /><em> Serial.begin(9600);</em><br /><em> delay(10);</em><br /> <br /> <br /><em> pinMode(relayPin1, OUTPUT);</em><br /><em> pinMode(relayPin2, OUTPUT);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /> <br /><em> // Connect to WiFi network</em><br /><em> Serial.println();</em><br /><em> Serial.println();</em><br /><em> Serial.print("Connecting to ");</em><br /><em> Serial.println(ssid);</em><br /> <br /><em> WiFi.begin(ssid, password);</em><br /> <br /><em> while (WiFi.status() != WL_CONNECTED) {</em><br /><em> delay(500);</em><br /><em> Serial.print(".");</em><br /><em> }</em><br /><em> Serial.println("");</em><br /><em> Serial.println("WiFi connected");</em><br /> <br /><em> // Start the server</em><br /><em> server.begin();</em><br /><em> Serial.println("Server started");</em><br /> <br /><em> // Print the IP address</em><br /><em> Serial.print("Use this URL : ");</em><br /><em> Serial.print("http://");</em><br /><em> Serial.print(WiFi.localIP());</em><br /><em> Serial.println("/");</em><br /> <br /><em>}</em><br /> <br /><em>void loop() {</em><br /><em> // Check if a client has connected</em><br /><em> WiFiClient client = server.available();</em><br /><em> if (!client) {</em><br /><em> return;</em><br /><em> }</em><br /> <br /><em> // Wait until the client sends some data</em><br /><em> Serial.println("new client");</em><br /><em> while(!client.available()){</em><br /><em> delay(1);</em><br /><em> }</em><br /> <br /><em> // Read the first line of the request</em><br /><em> String request = client.readStringUntil('\r');</em><br /><em> Serial.println(request);</em><br /><em> client.flush();</em><br /> <br /><em> // Match the request</em><br /> <br /><em> int value = LOW;</em><br /><em> state = digitalRead(relayPin1); //USER</em><br /><em> if (request.indexOf("/LED=ON") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> value = HIGH;</em><br /><em> }</em><br /><em> if (request.indexOf("/LED=OFF") != -1)</em><br /><em> {</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> value = LOW;</em><br /><em> }</em></p>
<p><em>//USER</em><br /> <br /><em> if (request.indexOf("/LED=SWITCH") != -1 &amp;&amp; state == LOW)</em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> value = HIGH;</em><br /><em> }</em><br /><em> if (request.indexOf("/LED=SWITCH") != -1 &amp;&amp; state == HIGH)</em><br /><em> {</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> value = LOW;</em><br /><em> }</em><br /> <br /><em> if (request.indexOf("/ONE") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> }</em><br /> <br /><em> if (request.indexOf("/TWO") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> delay(2000);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> }</em><br /> <br /><em> if (request.indexOf("/THREE") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> delay(3000);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> }</em><br /> <br /><em> if (request.indexOf("/FIVE") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> delay(5000);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> }</em><br /> <br /><em> if (request.indexOf("/TEN") != -1) </em><br /><em> {</em><br /><em> digitalWrite(relayPin1, HIGH);</em><br /><em> delay(1000);</em><br /><em> digitalWrite(relayPin2, HIGH);</em><br /><em> delay(10000);</em><br /><em> digitalWrite(relayPin1, LOW);</em><br /><em> digitalWrite(relayPin2, LOW);</em><br /><em> }</em><br /> <br /><em> // Return the response</em><br /><em> client.println("HTTP/1.1 200 OK");</em><br /><em> client.println("Content-Type: text/html");</em><br /><em> client.println(""); // do not forget this one</em><br /><em> client.println("&lt;!DOCTYPE HTML&gt;");</em><br /><em> client.println("&lt;html&gt;");</em><br /> <br /><em> client.print("Relay is now: ");</em><br /> <br /><em> if(value == HIGH) {</em><br /><em> client.print("On"); </em><br /><em> } else {</em><br /><em> client.print("Off or temporarily ON");</em><br /><em> }</em><br /><em> client.println("&lt;br&gt;&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/LED=ON\"&gt;here&lt;/a&gt; to FIRE&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/LED=OFF\"&gt;here&lt;/a&gt; to STOP FIRING&lt;br&gt;");</em><br /><em> //USER</em><br /><em> client.println("Click &lt;a href=\"/LED=SWITCH\"&gt;here&lt;/a&gt; to SWITCHING firing state&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/ONE\"&gt;here&lt;/a&gt; to fire for 1 second&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/TWO\"&gt;here&lt;/a&gt; to fire for 2 seconds&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/THREE\"&gt;here&lt;/a&gt; to fire for 3 seconds&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/FIVE\"&gt;here&lt;/a&gt; to fire for 5 seconds&lt;br&gt;");</em><br /><em> client.println("Click &lt;a href=\"/TEN\"&gt;here&lt;/a&gt; to fire for 10 seconds&lt;br&gt;");</em><br /><em> client.println("&lt;/html&gt;");</em><br /> <br /><em> delay(1);</em><br /><em> Serial.println("Client disconnected");</em><br /><em> Serial.println("");</em><br /> <br /><em>}</em></p>
<p><em>===================================================</em></p>
<p>P.S: A picture of a good dog</p>
<p><span style="background-color: #ffffff;"><em><img src="http://lifestylepubs.wordpress.s3-us-west-2.amazonaws.com/app/uploads/prod/2016/08/Cas.jpg" alt="" width="1200" height="800" /></em></span></p>
